function get_tokens(t,e){var a=[];do{var n=t.indexOf(e);n>0?a.push(t.substr(0,n)):t.length>0&&a.push(t),t=t.substr(n+1)}while(n>0);return a}function redraw_loads(t){var e=t.getElementsByTagName("load");if(e)for(var a=0;a<e.length;a++)e[a].attributes&&pathes.push(e[a])}function redraw_buttons(t){var e=t.getElementsByTagName("button");for(var a in e)e[a].attributes&&e[a].attributes.href&&(e[a].onclick=function(){clearInterval(stream),window.location.hash=this.getAttribute("href")})}function get_html(t,e){html_loaded=!1;var a=getXmlHttp();a.open("GET",t,!0),a.onreadystatechange=function(){4==a.readyState&&200==a.status&&(e.innerHTML=a.responseText,redraw_loads(e),redraw_buttons(e),html_loaded=!0)},a.send(null)}function set_path(t){clearInterval(stream),html_loaded=!0;var e=get_tokens(t,"/"),a=get_tokens(old_path,"/"),n=0;if(is_init)for(;n<e.length&&(a[n]&&e[n]==a[n]);n++);var r=document.getElementsByTagName("button");stream=setInterval(function(){if(n>=e.length){if(clearInterval(stream),a[n])for(var t=document.getElementsByTagName("load");n<a.length;n++)if(r)for(var o=0;o<r.length;o++){var i=get_tokens(r[o].getAttribute("href"),"/");if(i[n]&&i[n]===a[n]&&t)for(var l=0;l<t.length;l++)if(t[l].getAttribute("place")===r[o].getAttribute("place")){t[l].innerHTML="";break}}}else if(html_loaded){if(html_loaded=!1,r)for(var o=0;o<r.length;o++){var i=get_tokens(r[o].getAttribute("href"),"/");if(i[n]&&i[n]===e[n]){var t=document.getElementsByTagName("load");if(t)for(var l=0;l<t.length;l++)if(t[l].getAttribute("place")===r[o].getAttribute("place")){get_html(r[o].getAttribute("src"),t[l]);break}}}n++}},1)}var stream,html_loaded=!0,is_init=!1,old_path=window.location.hash.slice(1),last_ui;window.onpopstate=function(){set_path(window.location.hash.slice(1)),old_path=window.location.hash.slice(1)};var pathes=[];is_require?(window.onpopstate(),is_init=!0,redraw_loads(document),redraw_buttons(document)):window.onload=function(){window.onpopstate(),is_init=!0,redraw_loads(document),redraw_buttons(document)},console.log(window),is_require=!1;